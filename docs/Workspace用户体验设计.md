## ✅ **核心目标复述：Clean + AI First + 沉浸式创作**

Workspace 应成为用户的：

* **入口即沉浸**（无干扰界面）
* **统一工作容器**（多文档、多工具、多模式的载体）
* **动态 AI 协作场所**（非按钮式 AI，而是“并行存在”的智能协作者）

---

## 🧭 Workspace 用户全流程体验

| 阶段         | 用户意图                      | 交互组件                           | 系统响应 / UX 特性          |
| ---------- | ------------------------- | ------------------------------ | --------------------- |
| 1. 进入工作区   | 选择 / 创建一个项目（文档 / 知识 / 学习） | `/workspace/[id]?mode=writing` | 快速加载上次状态（AI 提示、结构、模式） |
| 2. 聚焦创作    | 编辑、嵌入、引用、生成               | Editor + ToolKit + Agent       | 沉浸式 UI、无头导航、键盘操作优先    |
| 3. 多模态切换   | 切换视图（图谱 / 表格 / Canvas）    | 顶部模式切换菜单（mode）                 | 无刷新切换，局部状态保持，渐变过渡     |
| 4. AI 协作   | 补全、改写、总结、查资料              | `/agent` + inline 命令 + 侧边任务面板  | 并行提示流、语义化交互界面         |
| 5. 结构管理    | 分块 / 引用 / 拖拽组织内容          | Outliner + Block操作器            | 拖拽手柄 + AI 推荐结构调整      |
| 6. 版本/回滚   | 恢复历史版本、比较差异               | `/workspace/[id]/history`      | AI 高亮差异 + 语义回滚建议      |
| 7. 多文档跳转   | 引用其他文档或子文档                | `/workspace/[id]/[sub]`        | 全局引用预览卡 + 快捷跳转        |
| 8. 导出 / 分享 | 输出 PDF / Slide / 图谱       | Export 工具栏                     | 模态选择 + 结构预览           |

---

## 🧱 Workspace 路由结构设计（支持扩展、清晰、语义化）

```tsx
/routes
├── /                        // 首页 / Dashboard
├── /explore                // 模板市场 / 推荐作品
├── /search                 // 跨文档搜索 + 问答
├── /workspace              // 工作区容器
│   ├── /new                // 创建新的 Workspace
│   ├── /[id]               // Workspace 主视图（核心编辑器）
│   │   ├── ?mode=writing       // 文本视图（默认）
│   │   ├── ?mode=graph         // 知识图谱视图
│   │   ├── ?mode=canvas        // 白板视图
│   │   ├── ?mode=table         // 数据表格视图
│   │   ├── ?mode=timeline      // 时间线视图
│   │   └── ?mode=card          // 卡片视图
│   ├── /[id]/history       // 历史版本管理
│   ├── /[id]/settings      // 权限、标签、元数据等设置
│   ├── /[id]/export        // 导出 / 多格式预览
│   ├── /[id]/plugins       // Workspace 专属插件管理
│   ├── /[id]/files         // 引用的媒体、数据、PDF等管理
├── /agent                  // 全局 AI Agent，支持插入任务
├── /profile                // 用户个人信息 / 订阅中心
```

---

## 🪄 Workspace UI Layout（沉浸式 + 功能可拉出）

```tsx
<WorkspaceLayout>
  <Header mode={mode} />               // 顶部：只在写作时可隐藏
  <EditorCore mode={mode} />           // 主区域：按模式切换视图
  <AIInlineActions />                  // 编辑器内触发 AI 工具条（智能感知）
  <FloatingAgent />                    // 底部浮动智能体：非干扰式并行智能提示
  <SidebarPanel />                     // 可唤出（结构 / 图谱 / 搜索 / 插件）
</WorkspaceLayout>
```

---

## 🧩 插件（Plugin）机制设计

> 不做插件商店的 Notion 复制，而是“无界扩展场景”的插件机制

| 插件类型  | 示例               | 插入位置          | 用户触发方式                 |
| ----- | ---------------- | ------------- | ---------------------- |
| 内容插件  | 代码块高亮、LaTeX、引用翻译 | 编辑器 Block 中   | `/slash command` / 快捷键 |
| 数据插件  | 表格、任务面板、进度图      | 页面中段 / Block  | 插入模板 / AI 生成推荐         |
| AI 插件 | 翻译、润色、论文检索       | 文本选择或浮动栏      | AI Agent 配置面板          |
| 交互插件  | PDF 阅读器、视频播放器    | 全屏 Panel / 分屏 | 插件中心 / AI 推荐激活         |

---

## 🎯 用户从首页进入 Workspace 的路径设计

### 模式一：已有项目

1. 访问 `/` 或 `/workspace`
2. 点击某个已有 Workspace 卡片（包括场景图标、摘要、上次打开状态）
3. 跳转至 `/workspace/[id]?mode=writing`

### 模式二：新建项目

1. 点击「新建」按钮（浮动 or 首页卡片）
2. 弹出场景选择器（Writing、Research、Planning…）
3. 初始化模版并进入 `/workspace/[new-id]?mode=auto`（根据场景推断初始模式）

---

## 🔄 多文档跳转与子文档结构

> Workspace 不是单文档，而是“文档树 + AI Agent 状态 + 关系图谱”

可以支持子路由：

```
/workspace/abc123                     → 主文档
/workspace/abc123/notes/xyz456       → 结构化子笔记
/workspace/abc123/ref/789def         → AI 自动引用生成的知识片段
```

* 内部链接使用语义化卡片（引用、预览、插入）
* 支持 block-level 引用（嵌入原文、AI 翻译等）

---

## 🧠 补充建议

* **保持 Editor 与 Workspace 解耦**：Editor 是渲染/交互引擎，Workspace 是场景容器
* **AI 不要通过浮窗存在感强呈现**，而是：在内容中“嵌入提示、补全、推荐”
* **不建议引入 Tab 结构**，而采用临时悬浮卡 / 快捷跳转器（`cmd + k`）

---

## 📌 总结

> Workspace 是你产品的「场景容器 + 沉浸空间 + AI 协作核心」。这套路由与用户流程设计，力求做到：

* **极简主界面，但不牺牲功能深度**
* **支持未来功能增长（插件、模式切换）不破坏结构**
* **让用户始终「在创作状态」，AI 并行协助，不突兀打断**

如你愿意，我们下一步可以一起设计：

* 工作区内部子文档的组织方式（文档树 vs Tag 聚类）
* 插件系统的注册/使用机制（全局 vs Workspace 特定）
* 模板系统如何自动搭建文档结构（含 AI）

需要我推进哪一部分？

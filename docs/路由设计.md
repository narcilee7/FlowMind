# 路由结构设计

你倾向将 “Editor” 视为「Workspace」本体，这很合理。我建议按照以下逻辑来组织路由：

### 🧭 顶层路由结构：

```
/
├── workspace/                       ← 编辑器入口（沉浸式）
│   ├── [workspaceId]/              ← 每个 Workspace（文档/项目/知识宇宙）
│   │   ├── mode=writing            ← 写作模式
│   │   ├── mode=research           ← 研究模式
│   │   ├── mode=canvas             ← Canvas/计划模式
│   │   └── mode=graph              ← 知识图谱编辑器
│   └── new?template=research       ← 创建新 Workspace（带模板）
├── explore/                        ← AI 生成灵感池/发现区
├── search/                         ← 全局语义搜索 + 知识问答
├── tools/                          ← 你的工具集（插件、图谱工具、画布生成器等）
│   └── [toolId]/
├── templates/                      ← 场景模板库（写作、研究、学习）
│   └── [templateId]/
├── plugins/                        ← 插件市场（未来生态方向）
│   └── [pluginId]/
├── account/
├── pricing/
└── settings/
```

> 所有核心功能都围绕 `workspace/[id]?mode=` 延展，实现「一个入口，多个维度」。

---

### 🔍 示例 URL：

* `workspace/4f21r?mode=writing` → 写作模式（富文本）
* `workspace/4f21r?mode=graph` → 同一个文档的图谱视图
* `workspace/new?template=ai-research` → 创建带研究模板的新 Workspace
* `tools/graph-inspector` → 图谱关系查看器（独立工具页）
* `plugins/slides-generator` → 幻灯片生成器插件页面

---

## 2️用户路径与信息架构（IA + UX Flow）

> Clean 体验 ≠ 功能少，而是“只在对的时间展示对的功能”

### 🧠 全流程用户路径设计：

```
首次用户
 └→ /workspace/new  (从模板/空白创建)
     └→ 选择模板 (Writing, Research, Planning)
         └→ /workspace/abc123?mode=writing

老用户
 └→ / (或 /workspace)
     └→ 最近打开的 Workspace（Auto Resume）
         └→ 进入沉浸式 Editor

写作时需要资料
 └→ 打开 Floating AI Agent
     └→ 插入工具：文献、摘要、图谱等

研究中需要切换结构视图
 └→ 切换 `mode=graph` 或 `mode=table`
```

### 📌 Clean AI First 原则的交互策略：

| 动作    | UI 行为                                | 原则说明              |
| ----- | ------------------------------------ | ----------------- |
| 创建文档  | 不显示冗余按钮，仅一个「+ 新建」按钮                  | 只展现核心入口           |
| 插件调用  | 所有插件通过 FloatingAgent 或 `/` 快捷键菜单调出   | 减少显式工具栏           |
| 模式切换  | 上方 `mode` 切换 Tab，或通过 Cmd+K / Palette | 不打断当前创作           |
| 搜索知识  | 全局 Cmd+P / Search 快捷调用               | 不需要离开当前 Workspace |
| AI 帮助 | 悬浮按钮 / 快捷键触发（对话框风格）                  | 沉浸式，不弹出新页         |

---

## 3️⃣ 编辑器内部结构建议（插件机制）

要保证长远的「功能可扩展 + 编辑器始终保持干净」，核心是：

### ✅ 插件能力集中于两种位置：

1. `FloatingAgent` 中间件式弹出（主交互载体）
2. `/` Slash Command 菜单（组件级插件）
3. `Cmd+K`（快速搜索 + 插件命令）

---

### 🧱 插件注入机制（建议架构）：

每个插件都定义为：

```ts
type EditorPlugin = {
  id: string
  name: string
  icon?: ReactNode
  renderUI?: () => ReactNode      // 可插入 UI（如图谱可视化）
  run?: (context: EditorContext) => void // 命令式执行（生成摘要、分析图谱等）
  insertBlock?: (pos: number) => ASTNode
  slashCommand?: string           // 用于 /
}
```

注册机制：

```ts
registerPlugin({
  id: 'graph-visualizer',
  name: '图谱查看器',
  slashCommand: 'graph',
  renderUI: () => <GraphCanvas />,
})
```

---

## 🧩 关于 Tool、Template、Plugin 的区别和路由建议：

| 类型       | 描述                     | 示例路径                     | UI 表现方式            |
| -------- | ---------------------- | ------------------------ | ------------------ |
| Template | 初始化文档的场景配置             | `/templates/ai-writing`  | 创建时选择              |
| Tool     | 对已有 Workspace 的分析/操作工具 | `/tools/graph-inspector` | Agent 插件 / 新页      |
| Plugin   | 编辑器内可插入的功能模块           | `/plugins/slides-gen`    | `/` 插入 or Agent 调用 |

---

## ✅ 总结：推荐设计策略

1. **一切核心编辑行为聚焦于 `workspace/[id]?mode=`**
2. 所有功能以 Plugin / Tool 形式注入，但呈现方式统一沉浸式交互（Agent、快捷菜单）
3. 路由层尽量少 → `/workspace`, `/tools`, `/explore`，功能通过动态交互层呼出
4. 后续可扩展 `/api`, `/embed`, `/integration`, `/team/:id` 等企业需求

---
